@inject IDriver _driver
@inject NavigationManager _manager

<div class="bg-light border rounded p-2 m-2 d-flex flex-row align-items-center">
    <div class="flex-grow-1">
        <h1>@Relation.Name</h1>
        <h3>@Relation.FirstClassName - @Relation.SecondClassName</h3>
    </div>
    @if (!_delete)
    {
        <button class="btn btn-primary m-2" @onclick="Open">Открыть</button>
        <button class="btn btn-danger m-2" @onclick="Delete">Удалить</button>
    }
    else
    {
        <p>Удаление...</p>
    }
</div>

@code {
    [Parameter]
    public Relation Relation { get; set; } = null;
    [Parameter]
    public string DbName { get; set; } = "";

    private bool _delete = false;

    private void Open()
    {
        _manager.NavigateTo($"/DbMain/{DbName}/rel/{Relation.Name}");
    }

    private async void Delete()
    {
        IResultCursor cursor;
        IAsyncSession session = _driver.AsyncSession(c => c.WithDatabase(DbName));
        try
        {
            cursor = await session.RunAsync(@$"match ()-[r:{Relation.Name}]-() delete r");
        }
        finally
        {
            await session.CloseAsync();
        }
        _delete = true;
        StateHasChanged();
    }
}